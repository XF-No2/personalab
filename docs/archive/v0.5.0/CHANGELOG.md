# PersonaLab 更新日志

## [v0.5.0] - 2025-10-16

### 文档模块化

**拆分设计文档，模块化详细设计**

#### DESIGN_OVERVIEW.md v0.5.0
- **精简32%**：从750行减少到506行
- **删除详细内容**：
  - 数据结构格式定义（移至 data_structure.md）
  - 导演模块详细设计（移至 director.md）
  - RAG检索策略详细设计（移至 rag.md）
  - 角色人格机制详细设计（移至 persona.md）
  - 配置系统详细设计（移至 config.md）
- **保留核心内容**：
  - 项目概述和架构总览
  - 核心流程（对话交互、汇总、更新记忆、会话编辑、Prompt组装）
  - 核心设计原则
  - 关键技术决策
- **新增索引表格**：顶部添加模块文档索引，便于快速查阅

#### 新增模块文档（docs/design/）
- **data_structure.md** (301行)
  - 底层数据字典，定义所有数据格式
  - 会话文件格式（JSONL）、状态文件格式（JSON）
  - Chroma向量库格式（Summaries + Plots Collection）

- **director.md** (266行)
  - 导演模块详细设计
  - 情节点设置、进度引导、容错处理（RAG兜底）
  - LLM Prompt设计、与其他模块的交互

- **rag.md** (220行)
  - RAG检索策略详细设计
  - 日常对话RAG检索、深度搜索策略、分层摘要机制
  - Chroma查询参数、与其他模块的交互

- **persona.md** (206行)
  - 角色人格机制详细设计
  - 两层人格（base_persona + evolved_persona）
  - Prompt组装策略、更新记忆流程、LLM Prompt设计

- **config.md** (253行)
  - 配置系统详细设计
  - 全局配置文件格式（config.json）
  - 功能开关、前端控制、配置加载机制

#### 拆分效果
- **零依赖设计**：各模块文档自包含，只依赖 data_structure.md
- **易查阅**：通过索引快速定位详细设计
- **保留流程**：DESIGN_OVERVIEW.md 保留核心流程，方便理解全局运作机制
- **易维护**：每个模块文档200-300行，清晰聚焦，修改一个模块不影响其他模块

## [v0.4.0] - 2025-10-16

### 文档重构

**重构需求和设计文档，去除冗余并明确职责边界**

#### REQUIREMENTS.md v3.0
- **精简46%**：从792行减少到425行
- **删除设计细节**：
  - 导演模块的实现细节（`[PROGRESS]`标记、正则扫描、Python代码）
  - 两层人格机制的实现细节（Prompt位置、维护流程）
  - RAG检索的代码示例（Python代码、Chroma查询）
  - 数据结构定义（JSON格式）
  - Prompt区域分配策略
- **保留核心内容**：
  - 项目定位和基本概念
  - 核心需求的问题描述和期望
  - 功能需求列表
  - UI布局设计
  - 需求澄清记录
- **新增需求追溯**：每个需求末尾添加设计文档引用

#### DESIGN_OVERVIEW.md v0.4.0
- **新增章节**：
  - 第3.5章"Prompt组装策略"（基于LLM注意力机制U型特点的区域分配）
  - 第5.1章"日常对话RAG检索（Conversational RAG）"（详细描述触发时机、检索流程和关键特性）
- **修正表述**：
  - 汇总功能"所有Summaries"明确为"当前会话的所有Summaries"
- **删除冗余**：
  - 删除重复的"5.2 RAG检索范围"章节
- **需求追溯**：
  - 为第3.5、4、5、6章添加需求追溯链接

#### 重构效果
- **职责清晰**：需求文档专注"做什么"，设计文档专注"怎么做"
- **去除冗余**：相同内容只保留一份，减少50%的重复
- **便于维护**：修改一次，不用同步多个文档
- **逻辑连贯**：架构设计→运作机制，一个文档内形成完整闭环

## [v0.1.0] - 2025-10-10

### 项目初始化

- 创建标准项目目录结构
- 从全局模板复制规范.md
- 创建基础文档（PROJECT_STATUS.md, README.md, CHANGELOG.md）
